{"version":3,"sources":["../src/block_form_handler.js"],"names":["define","$","window","presenterIntervalHandle","presentationIntervalHandle","presenterRun","presentationRun","afterUpload","clearInterval","removeAttr","autocompletePrettifier","each","i","elm","input","find","hasClass","addClass","init","hide","on","e","toggle","preventDefault","filelist","currentTarget","video_identifier","parent","siblings","attr","setInterval","setTimeout"],"mappings":"AAuBAA,OAAM,qCAAC,CAAC,QAAD,CAAD,CAAa,SAAUC,CAAV,CAAa,CAK5BC,MAAM,CAACC,uBAAP,CAAiC,IAAjC,CACAD,MAAM,CAACE,0BAAP,CAAoC,IAApC,CACAF,MAAM,CAACG,YAAP,IACAH,MAAM,CAACI,eAAP,IAMA,QAASC,CAAAA,CAAT,EAAuB,CACnB,GAAI,CAACL,MAAM,CAACI,eAAR,EAA2B,CAACJ,MAAM,CAACG,YAAvC,CAAqD,CACjDG,aAAa,CAACN,MAAM,CAACE,0BAAR,CAAb,CACAI,aAAa,CAACN,MAAM,CAACC,uBAAR,CAAb,CACAF,CAAC,CAAC,yBAAD,CAAD,CAA2BQ,UAA3B,CAAsC,UAAtC,CACH,CACJ,CAMD,QAASC,CAAAA,CAAT,EAAkC,CAC9BT,CAAC,CAAC,sCAAD,CAAD,CAAwCU,IAAxC,CAA6C,SAAUC,CAAV,CAAaC,CAAb,CAAkB,CAC3D,GAAIC,CAAAA,CAAK,CAAGb,CAAC,CAACY,CAAD,CAAD,CAAOE,IAAP,CAAY,OAAZ,CAAZ,CACA,GAAI,CAACD,CAAK,CAACE,QAAN,CAAe,cAAf,CAAL,CAAqC,CACjCF,CAAK,CAACG,QAAN,CAAe,cAAf,CACH,CACJ,CALD,CAMH,CAmDD,MAAO,CACHC,IAAI,CA9CG,QAAPA,CAAAA,IAAO,EAAY,CAEnBjB,CAAC,CAAC,aAAD,CAAD,CAAiBkB,IAAjB,GACAlB,CAAC,CAAC,oBAAD,CAAD,CAAwBmB,EAAxB,CAA2B,OAA3B,CAAoC,SAAUC,CAAV,CAAa,CAC7CpB,CAAC,CAAC,aAAD,CAAD,CAAiBqB,MAAjB,GACAD,CAAC,CAACE,cAAF,EACH,CAHD,EAKAtB,CAAC,CAAC,sBAAD,CAAD,CAA0BmB,EAA1B,CAA6B,MAA7B,CAAqC,SAAUC,CAAV,CAAa,IAC1CG,CAAAA,CAAQ,CAAGH,CAAC,CAACI,aAD6B,CAE1CC,CAAgB,CAAGzB,CAAC,CAACuB,CAAD,CAAD,CAAYG,MAAZ,GAAqBC,QAArB,CAA8B,mBAA9B,EAAmDC,IAAnD,CAAwD,MAAxD,CAFuB,CAI9C5B,CAAC,CAAC,yBAAD,CAAD,CAA2B4B,IAA3B,CAAgC,UAAhC,CAA4C,UAA5C,EAEA,GAAwB,iBAApB,EAAAH,CAAJ,CAA2C,CACvCzB,CAAC,CAACuB,CAAD,CAAD,CAAYP,QAAZ,CAAqB,qBAArB,EACAf,MAAM,CAACC,uBAAP,CAAiC2B,WAAW,CAAC,UAAY,CACrD5B,MAAM,CAACG,YAAP,IACA,GAAI,CAACJ,CAAC,CAAC,sBAAD,CAAD,CAA0Be,QAA1B,CAAmC,sBAAnC,CAAL,CAAiE,CAC7Dd,MAAM,CAACG,YAAP,IACAE,CAAW,EACd,CACJ,CAN2C,CAMzC,GANyC,CAO/C,CATD,IASO,CACHN,CAAC,CAACuB,CAAD,CAAD,CAAYP,QAAZ,CAAqB,wBAArB,EACAf,MAAM,CAACC,uBAAP,CAAiC2B,WAAW,CAAC,UAAY,CACrD5B,MAAM,CAACI,eAAP,IACA,GAAI,CAACL,CAAC,CAAC,yBAAD,CAAD,CAA6Be,QAA7B,CAAsC,sBAAtC,CAAL,CAAoE,CAChEd,MAAM,CAACI,eAAP,IACAC,CAAW,EACd,CACJ,CAN2C,CAMzC,GANyC,CAO/C,CAEJ,CA1BD,EA6BAwB,UAAU,CAAC,UAAY,CACnBrB,CAAsB,GACtBT,CAAC,CAAC,mBAAD,CAAD,CAAuBmB,EAAvB,CAA0B,OAA1B,CAAmC,UAAY,CAC3CV,CAAsB,EACzB,CAFD,CAGH,CALS,CAKP,GALO,CAMb,CAEM,CAGV,CAvFK,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript to initialise the opencast block.\n *\n * @package    block_opencast\n * @copyright  2019 Farbod Zamani (zamani@elan-ev.de)\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery'], function ($) {\n    /**\n     * Instantiate the window variable in order to work with Intervals\n     *\n     */\n    window.presenterIntervalHandle = null;\n    window.presentationIntervalHandle = null;\n    window.presenterRun = false;\n    window.presentationRun = false;\n\n    /**\n     * Clears intervals and enables Save Change Button after upload process is completed\n     *\n     */\n    function afterUpload() {\n        if (!window.presentationRun && !window.presenterRun) {\n            clearInterval(window.presentationIntervalHandle);\n            clearInterval(window.presenterIntervalHandle);\n            $('[name=\"submitbutton\"]').removeAttr('disabled');\n        }\n    }\n\n    /**\n     * Makes sure that autocomplete fields receive the form-control class in order to have consistency\n     *\n     */\n    function autocompletePrettifier() {\n        $('div[data-fieldtype=\"autocomplete\"]').each(function (i, elm) {\n            var input = $(elm).find('input');\n            if (!input.hasClass('form-control')) {\n                input.addClass('form-control');\n            }\n        });\n    }\n\n    /**\n     * Initialise all of the modules for the opencast block.\n     *\n     */\n    var init = function () {\n        // Toggle visibility of terms of use\n        $('#termsofuse').hide();\n        $('#termsofuse_toggle').on('click', function (e) {\n            $('#termsofuse').toggle();\n            e.preventDefault();\n        });\n\n        $('.filepicker-filelist').on('drop', function (e) {\n            var filelist = e.currentTarget;\n            var video_identifier = $(filelist).parent().siblings('.filepickerhidden').attr('name');\n\n            $('[name=\"submitbutton\"]').attr('disabled', 'disabled');\n\n            if (video_identifier == 'video_presenter') {\n                $(filelist).addClass('presenter-uploading');\n                window.presenterIntervalHandle = setInterval(function () {\n                    window.presenterRun = true;\n                    if (!$('.presenter-uploading').hasClass('dndupload-inprogress')) {\n                        window.presenterRun = false;\n                        afterUpload();\n                    }\n                }, 500);\n            } else {\n                $(filelist).addClass('presentation-uploading');\n                window.presenterIntervalHandle = setInterval(function () {\n                    window.presentationRun = true;\n                    if (!$('.presentation-uploading').hasClass('dndupload-inprogress')) {\n                        window.presentationRun = false;\n                        afterUpload();\n                    }\n                }, 500);\n            }\n\n        });\n\n        // Ensures that autocomplete fields are loaded properly after 1 sec!\n        setTimeout(function () {\n            autocompletePrettifier();\n            $('.moreless-actions').on('click', function () { //\n                autocompletePrettifier();\n            });\n        }, 1000);\n    };\n\n    return {\n        init: init\n    };\n});\n\n"],"file":"block_form_handler.min.js"}